# VECTOR ARENA - Java通信対戦型アクションゲーム

## 概要
**VECTOR ARENA** は、Java標準ライブラリ（Swing/AWT）のみを用いてゼロから開発された、2D見下ろし型のオンライン対戦アクションゲームです。
既存のゲームエンジンを使用せず、描画エンジン、物理判定、通信同期処理などをすべて独自に実装しています。

単なる反射神経ゲームではなく、ラウンド敗北時に強力な能力を取得できる「ローグライク要素」を導入しており、実力差があっても戦略次第で逆転可能なゲームデザインとなっています。

## 特徴
* **完全独自の描画・物理エンジン**: Javaの `Graphics2D` を駆使したUI/エフェクト描画と、計算に基づいた物理反射挙動。
* **ローグライク強化システム**: ラウンド敗者は3枚のランダムなカードから1つ能力を選択可能（毒、透明化、弾幕、巨大化など20種類以上）。
* **戦略的なマップ**: 障害物の配置が異なる3種類のマップ（平原・通路・要塞）をホストが選択可能。
* **堅牢な設計**: デザインパターン（Strategy, Factory）やオブジェクトプーリングを採用し、拡張性とパフォーマンスを確保。

## 動作環境
* **OS**: Windows 推奨
* **Java**: Java Runtime Environment (JRE) 8 以上
* **ネットワーク**: TCP/IP (ポート 10000を使用)

## インストールとコンパイル

本プロジェクトはUTF-8でコーディングされています。

### ソースコード構成
```text
src/
 ├── MyServer2.java        // サーバープログラム
 └── game/
      ├── ActionClient.java // クライアントメイン
      ├── GameLogic.java    // ゲームロジック
      └── ... (他クラスファイル)
```

### コンパイル方法
コマンドプロンプトで `src` ディレクトリに移動し、以下のコマンドを実行してください。
※ 文字化けを防ぐため、エンコーディング指定が必要です。

```cmd
javac -encoding UTF-8 MyServer2.java
javac -encoding UTF-8 game/*.java
```

## 起動方法

### 1. サーバーの起動
対戦を行うためには、まずサーバーを立ち上げる必要があります。

```cmd
java MyServer2
```
※ 「=== Action Game Server (UTF-8) Started ===」と表示されれば成功です。

### 2. クライアントの起動（Player1 / Host）
新しいコマンドプロンプトを開き、クライアントを起動します。

```cmd
java game.ActionClient
```

起動時に入力ダイアログが表示されます。
* **ローカルでテストする場合**: 空欄のまま `OK` を押してください（デフォルトで `127.0.0.1` に接続します）。
* **LAN対戦の場合**: サーバーPCのIPアドレスを入力してください。

### 3. 対戦相手の参加（Player2 / Guest）
別のPC（または別のコマンドプロンプト）で同様に `java game.ActionClient` を実行し、サーバーのIPアドレスを入力して接続します。

2人揃うと、Player1（ホスト）がマップを選択してゲームを開始できます。

## 操作方法

| キー / 操作 | 動作 | 備考 |
| :--- | :--- | :--- |
| **W, A, S, D** | 移動 | キャラクターの移動 |
| **マウス移動** | 照準 | カーソルの方向を向く |
| **左クリック** | 射撃 | クリックごとに発射（押しっぱなし連射不可） |
| **右クリック** | ガード | 防御シールド展開。ダメージ90%カット |

**特殊操作:**
* **ガードキャンセル**: 一部のスキル（Teleport, Invisibleなど）は、ガードした瞬間に発動します。
* **緊急防御**: 弾切れ時に自動でガードが発動するスキルもあります。

## ゲームルール

1.  **勝利条件**: 相手のHPを0にするとラウンド勝利。先に **5ラウンド** 先取したプレイヤーの完全勝利。
2.  **敗者強化**: ラウンドに負けたプレイヤーは、次のラウンド開始前にランダムに提示される3つのパワーアップから1つを選んで取得できます。

### パワーアップ（能力）の例
`PowerUp.java` および `WeaponEffect` により実装された能力の一例です。

* **攻撃強化系**
    * **Shotgun**: 射程は短いが、広範囲に20発以上の弾をばら撒く。
    * **Shower**: 制御不能な弾を乱射する。毒や吸血と相性が良い。
    * **Impact**: 単発威力と弾速が倍になるが、連射が遅くなる。
* **特殊効果系**
    * **Poison**: 弾が当たるたびに毒スタックを付与し、継続ダメージを与える。
    * **Reflect**: 弾が壁で反射する回数が増える。
    * **Ghost**: 発射直後の弾が壁を貫通する。
* **スキル系（右クリック連動）**
    * **Invisible**: ガードすると一時的に姿が透明になる。
    * **Teleport**: ガードすると進行方向にワープする。
    * **The World**: ガードした瞬間、周囲の時間を止め（弾を消去し）、身を守る。
* **キャラクター変異**
    * **Big Boy**: HPが1.5倍になるが、体が巨大化し被弾しやすくなる。
    * **Idaten (韋駄天)**: 移動速度が極端に上がるが、HPが半減する。

## 技術的アピールポイント

本プログラムでは、保守性とパフォーマンスを重視した以下の技術的工夫を行っています。

1.  **Strategyパターンの採用**
    * 武器の特殊能力（毒、反射、拡散など）を `WeaponEffect` クラスとしてカプセル化し、リスト構造で管理。これにより、本体コードを修正することなく新しい能力を無限に追加可能です。
2.  **オブジェクトプーリング**
    * 弾幕系シューティングで問題となるGC（ガベージコレクション）によるラグを防ぐため、弾丸オブジェクトを事前生成し再利用する仕組みを実装。多数の弾が飛び交っても60FPSを維持します。
3.  **独自入力ハンドラ**
    * OS標準のキーリピート遅延による操作の引っかかりを解消するため、`InputHandler` クラスでキー状態をフラグ管理し、滑らかな移動を実現しました。
4.  **通信量の最適化**
    * リアルタイム通信において、プレイヤーの状態（リロード中、ガード中、透明化など）をビットフラグとして1つの整数値に圧縮して送信し、帯域を節約しています。

## トラブルシューティング

* **Q. 起動しない**: Javaのバージョンを確認してください（`java -version`）。クラスパスが通っているか確認してください。
* **Q. 文字化け**: ソースコードはUTF-8です。Windowsのデフォルト（Shift-JIS）環境でコンパイルするとエラーが出ることがあります。必ず `-encoding UTF-8` オプションをつけてください。
* **Q. 通信できない**: ファイアウォール設定でJavaの通信を許可してください。ポート10000番を使用します。